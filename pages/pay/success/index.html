<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Оплата прошла успешно — StarsBox</title>
  <meta name="robots" content="noindex,nofollow" />
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    :root { --bg:#0e0f14; --card:#141825; --ok:#22c55e; --muted:#9aa3b2; --fg:#fff; }
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--fg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial}
    .wrap{min-height:100%;display:grid;place-items:center;padding:24px}
    .card{max-width:560px;width:100%;background:var(--card);border-radius:20px;padding:24px;box-shadow:0 10px 30px rgba(0,0,0,.35)}
    h1{margin:0 0 10px;font-size:22px}
    .ok{color:var(--ok);font-weight:600}
    .meta{margin:8px 0 16px;color:var(--muted);font-size:14px;line-height:1.45}
    .actions{display:grid;gap:12px;margin-top:8px}
    .btn{appearance:none;border:0;border-radius:12px;padding:14px 16px;font-size:16px;font-weight:600;cursor:pointer}
    .btn-primary{background:#2b6de9;color:#fff}
    .btn-outline{background:transparent;color:#cbd5e1;border:1px solid rgba(255,255,255,.15)}
    a.btn{display:inline-block;text-align:center;text-decoration:none}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>✅ Оплата <span class="ok">успешна</span></h1>
      <p class="meta">
        Заказ: <strong id="orderId">—</strong><br/>
        Статус провайдера: <strong id="provStatus">Success</strong>
      </p>
      <div class="actions">
        <!-- КНОПКА ВОЗВРАТА В МИНИ-АПП -->
        <a id="backBtn" class="btn btn-primary" href="#" rel="noopener">Вернуться в мини-апп</a>
        <!-- запасной вариант -->
        <a id="fallbackBtn" class="btn btn-outline" href="#" rel="noopener">Открыть в Telegram</a>
      </div>
    </div>
  </div>

  <script>
    // === НАСТРОЙКА: укажи имя своего бота ===
    const BOT_USERNAME = 'StarssBox_bot'; // например: 'starsbox_bot'

    // читаем любые параметры, которые могли прилететь
    const qp = new URLSearchParams(location.search);
    const hp = new URLSearchParams(location.hash.slice(1));
    const orderId = qp.get('orderId') || qp.get('order_id') || hp.get('orderId') || hp.get('order_id') || '';
    const providerStatus = qp.get('status') || qp.get('provider_status') || hp.get('status') || 'Success';

    document.getElementById('orderId').textContent = orderId || '—';
    document.getElementById('provStatus').textContent = providerStatus || 'Success';

    // Формируем deep-link «вернуться» (откроет чат и стартанёт мини-апп со старт-параметром)
    // Форматы startapp корректно работают и с t.me, и с tg://
    const sp = orderId ? `resume:${encodeURIComponent(orderId)}` : 'resume';
    const tme = `https://t.me/${BOT_USERNAME}?startapp=${encodeURIComponent(sp)}`;
    const tg  = `tg://resolve?domain=${BOT_USERNAME}&startapp=${encodeURIComponent(sp)}`;

    const backBtn = document.getElementById('backBtn');
    const fbBtn   = document.getElementById('fallbackBtn');

    backBtn.href = tme;
    fbBtn.href   = tg;

    // Если вдруг доступно API — использовать openTelegramLink (чуть приятнее на iOS)
    try {
      if (window.Telegram && Telegram.WebApp && typeof Telegram.WebApp.openTelegramLink === 'function') {
        backBtn.addEventListener('click', (e) => { e.preventDefault(); Telegram.WebApp.openTelegramLink(tme); });
        fbBtn.addEventListener('click',   (e) => { e.preventDefault(); Telegram.WebApp.openTelegramLink(tg);  });
      }
    } catch {}
  </script>
</body>
</html>
